!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define("$vite_WS",[],t):"object"==typeof exports?exports.$vite_WS=t():e.$vite_WS=t()}(this,(function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={i:r,l:!1,exports:{}};return e[r].call(o.exports,o,o.exports,n),o.l=!0,o.exports}return n.m=e,n.c=t,n.d=function(e,t,r){n.o(e,t)||Object.defineProperty(e,t,{enumerable:!0,get:r})},n.r=function(e){"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(e,"__esModule",{value:!0})},n.t=function(e,t){if(1&t&&(e=n(e)),8&t)return e;if(4&t&&"object"==typeof e&&e&&e.__esModule)return e;var r=Object.create(null);if(n.r(r),Object.defineProperty(r,"default",{enumerable:!0,value:e}),2&t&&"string"!=typeof e)for(var o in e)n.d(r,o,function(t){return e[t]}.bind(null,o));return r},n.n=function(e){var t=e&&e.__esModule?function(){return e.default}:function(){return e};return n.d(t,"a",t),t},n.o=function(e,t){return Object.prototype.hasOwnProperty.call(e,t)},n.p="",n(n.s=389)}({108:function(e,t){e.exports=require("url")},158:function(e,t){e.exports=require("net")},159:function(e,t,n){var r=n(51),o=n(76),i=n(50).EventEmitter,s=n(198),a=n(400),c=n(401).Validation,u=o.bufferAllocUnsafe,h=o.bufferFromString;var l="setImmediate"in global?global.setImmediate.bind(global):process.nextTick.bind(process),f=0;function d(e,t,n,r,c){if(this._debug=o.BufferingLogger("websocket:connection",++f),this._debug("constructor"),this._debug.enabled&&function(e,t){if(!e._debug.enabled)return;var n=t.emit;for(var r in t.emit=function(t){e._debug("||| Socket Event  '%s'",t),n.apply(this,arguments)},t)"function"==typeof t[r]&&-1===["emit"].indexOf(r)&&function(n){var r=t[n];t[n]="on"!==n?function(){return e._debug("||| Socket method called:  %s",n),r.apply(this,arguments)}:function(){return e._debug("||| Socket method called:  %s (%s)",n,arguments[0]),r.apply(this,arguments)}}(r)}(this,e),i.call(this),this._pingListenerCount=0,this.on("newListener",(function(e){"ping"===e&&this._pingListenerCount++})).on("removeListener",(function(e){"ping"===e&&this._pingListenerCount--})),this.config=c,this.socket=e,this.protocol=n,this.extensions=t,this.remoteAddress=e.remoteAddress,this.closeReasonCode=-1,this.closeDescription=null,this.closeEventEmitted=!1,this.maskOutgoingPackets=r,this.maskBytes=u(4),this.frameHeader=u(10),this.bufferList=new a,this.currentFrame=new s(this.maskBytes,this.frameHeader,this.config),this.fragmentationSize=0,this.frameQueue=[],this.connected=!0,this.state="open",this.waitingForCloseResponse=!1,this.receivedEnd=!1,this.closeTimeout=this.config.closeTimeout,this.assembleFragments=this.config.assembleFragments,this.maxReceivedMessageSize=this.config.maxReceivedMessageSize,this.outputBufferFull=!1,this.inputPaused=!1,this.receivedDataHandler=this.processReceivedData.bind(this),this._closeTimerHandler=this.handleCloseTimer.bind(this),this.socket.setNoDelay(this.config.disableNagleAlgorithm),this.socket.setTimeout(0),this.config.keepalive&&!this.config.useNativeKeepalive){if("number"!=typeof this.config.keepaliveInterval)throw new Error("keepaliveInterval must be specified and numeric if keepalive is true.");if(this._keepaliveTimerHandler=this.handleKeepaliveTimer.bind(this),this.setKeepaliveTimer(),this.config.dropConnectionOnKeepaliveTimeout){if("number"!=typeof this.config.keepaliveGracePeriod)throw new Error("keepaliveGracePeriod  must be specified and numeric if dropConnectionOnKeepaliveTimeout is true.");this._gracePeriodTimerHandler=this.handleGracePeriodTimer.bind(this)}}else if(this.config.keepalive&&this.config.useNativeKeepalive){if(!("setKeepAlive"in this.socket))throw new Error("Unable to use native keepalive: unsupported by this version of Node.");this.socket.setKeepAlive(!0,this.config.keepaliveInterval)}this.socket.removeAllListeners("error")}function p(e){return!(e<1e3)&&(e>=1e3&&e<=2999?-1!==[1e3,1001,1002,1003,1007,1008,1009,1010,1011,1012,1013,1014].indexOf(e):e>=3e3&&e<=3999||(e>=4e3&&e<=4999||!(e>=5e3)&&void 0))}d.CLOSE_REASON_NORMAL=1e3,d.CLOSE_REASON_GOING_AWAY=1001,d.CLOSE_REASON_PROTOCOL_ERROR=1002,d.CLOSE_REASON_UNPROCESSABLE_INPUT=1003,d.CLOSE_REASON_RESERVED=1004,d.CLOSE_REASON_NOT_PROVIDED=1005,d.CLOSE_REASON_ABNORMAL=1006,d.CLOSE_REASON_INVALID_DATA=1007,d.CLOSE_REASON_POLICY_VIOLATION=1008,d.CLOSE_REASON_MESSAGE_TOO_BIG=1009,d.CLOSE_REASON_EXTENSION_REQUIRED=1010,d.CLOSE_REASON_INTERNAL_SERVER_ERROR=1011,d.CLOSE_REASON_TLS_HANDSHAKE_FAILED=1015,d.CLOSE_DESCRIPTIONS={1e3:"Normal connection closure",1001:"Remote peer is going away",1002:"Protocol error",1003:"Unprocessable input",1004:"Reserved",1005:"Reason not provided",1006:"Abnormal closure, no further detail available",1007:"Invalid data received",1008:"Policy violation",1009:"Message too big",1010:"Extension requested by client is required",1011:"Internal Server Error",1015:"TLS Handshake Failed"},r.inherits(d,i),d.prototype._addSocketEventListeners=function(){this.socket.on("error",this.handleSocketError.bind(this)),this.socket.on("end",this.handleSocketEnd.bind(this)),this.socket.on("close",this.handleSocketClose.bind(this)),this.socket.on("drain",this.handleSocketDrain.bind(this)),this.socket.on("pause",this.handleSocketPause.bind(this)),this.socket.on("resume",this.handleSocketResume.bind(this)),this.socket.on("data",this.handleSocketData.bind(this))},d.prototype.setKeepaliveTimer=function(){this._debug("setKeepaliveTimer"),this.config.keepalive&&!this.config.useNativeKeepalive&&(this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this._keepaliveTimeoutID=setTimeout(this._keepaliveTimerHandler,this.config.keepaliveInterval))},d.prototype.clearKeepaliveTimer=function(){this._keepaliveTimeoutID&&clearTimeout(this._keepaliveTimeoutID)},d.prototype.handleKeepaliveTimer=function(){this._debug("handleKeepaliveTimer"),this._keepaliveTimeoutID=null,this.ping(),this.config.dropConnectionOnKeepaliveTimeout?this.setGracePeriodTimer():this.setKeepaliveTimer()},d.prototype.setGracePeriodTimer=function(){this._debug("setGracePeriodTimer"),this.clearGracePeriodTimer(),this._gracePeriodTimeoutID=setTimeout(this._gracePeriodTimerHandler,this.config.keepaliveGracePeriod)},d.prototype.clearGracePeriodTimer=function(){this._gracePeriodTimeoutID&&clearTimeout(this._gracePeriodTimeoutID)},d.prototype.handleGracePeriodTimer=function(){this._debug("handleGracePeriodTimer"),this._gracePeriodTimeoutID=null,this.drop(d.CLOSE_REASON_ABNORMAL,"Peer not responding.",!0)},d.prototype.handleSocketData=function(e){this._debug("handleSocketData"),this.setKeepaliveTimer(),this.bufferList.write(e),this.processReceivedData()},d.prototype.processReceivedData=function(){if(this._debug("processReceivedData"),this.connected&&!this.inputPaused){var e=this.currentFrame;if(e.addData(this.bufferList)){var t=this;if(e.protocolError)return this._debug("-- protocol error"),void process.nextTick((function(){t.drop(d.CLOSE_REASON_PROTOCOL_ERROR,e.dropReason)}));if(e.frameTooLarge)return this._debug("-- frame too large"),void process.nextTick((function(){t.drop(d.CLOSE_REASON_MESSAGE_TOO_BIG,e.dropReason)}));if(e.rsv1||e.rsv2||e.rsv3)return this._debug("-- illegal rsv flag"),void process.nextTick((function(){t.drop(d.CLOSE_REASON_PROTOCOL_ERROR,"Unsupported usage of rsv bits without negotiated extension.")}));this.assembleFragments||(this._debug("-- emitting frame"),process.nextTick((function(){t.emit("frame",e)}))),process.nextTick((function(){t.processFrame(e)})),this.currentFrame=new s(this.maskBytes,this.frameHeader,this.config),this.bufferList.length>0&&l(this.receivedDataHandler)}else this._debug("-- insufficient data for frame")}},d.prototype.handleSocketError=function(e){this._debug("handleSocketError: %j",e),"closed"!==this.state?(this.closeReasonCode=d.CLOSE_REASON_ABNORMAL,this.closeDescription="Socket Error: "+e.syscall+" "+e.code,this.connected=!1,this.state="closed",this.fragmentationSize=0,o.eventEmitterListenerCount(this,"error")>0&&this.emit("error",e),this.socket.destroy(),this._debug.printOutput()):this._debug("  --- Socket 'error' after 'close'")},d.prototype.handleSocketEnd=function(){this._debug("handleSocketEnd: received socket end.  state = %s",this.state),this.receivedEnd=!0,"closed"!==this.state?"peer_requested_close"!==this.state&&"ending"!==this.state&&(this._debug("  --- UNEXPECTED socket end."),this.socket.end()):this._debug("  --- Socket 'end' after 'close'")},d.prototype.handleSocketClose=function(e){this._debug("handleSocketClose: received socket close"),this.socketHadError=e,this.connected=!1,this.state="closed",-1===this.closeReasonCode&&(this.closeReasonCode=d.CLOSE_REASON_ABNORMAL,this.closeDescription="Connection dropped by remote peer."),this.clearCloseTimer(),this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this.closeEventEmitted||(this.closeEventEmitted=!0,this._debug("-- Emitting WebSocketConnection close event"),this.emit("close",this.closeReasonCode,this.closeDescription))},d.prototype.handleSocketDrain=function(){this._debug("handleSocketDrain: socket drain event"),this.outputBufferFull=!1,this.emit("drain")},d.prototype.handleSocketPause=function(){this._debug("handleSocketPause: socket pause event"),this.inputPaused=!0,this.emit("pause")},d.prototype.handleSocketResume=function(){this._debug("handleSocketResume: socket resume event"),this.inputPaused=!1,this.emit("resume"),this.processReceivedData()},d.prototype.pause=function(){this._debug("pause: pause requested"),this.socket.pause()},d.prototype.resume=function(){this._debug("resume: resume requested"),this.socket.resume()},d.prototype.close=function(e,t){if(this.connected){if(this._debug("close: Initating clean WebSocket close sequence."),"number"!=typeof e&&(e=d.CLOSE_REASON_NORMAL),!p(e))throw new Error("Close code "+e+" is not valid.");"string"!=typeof t&&(t=d.CLOSE_DESCRIPTIONS[e]),this.closeReasonCode=e,this.closeDescription=t,this.setCloseTimer(),this.sendCloseFrame(this.closeReasonCode,this.closeDescription),this.state="ending",this.connected=!1}},d.prototype.drop=function(e,t,n){this._debug("drop"),"number"!=typeof e&&(e=d.CLOSE_REASON_PROTOCOL_ERROR),"string"!=typeof t&&(t=d.CLOSE_DESCRIPTIONS[e]),this._debug("Forcefully dropping connection. skipCloseFrame: %s, code: %d, description: %s",n,e,t),this.closeReasonCode=e,this.closeDescription=t,this.frameQueue=[],this.fragmentationSize=0,n||this.sendCloseFrame(e,t),this.connected=!1,this.state="closed",this.clearCloseTimer(),this.clearKeepaliveTimer(),this.clearGracePeriodTimer(),this.closeEventEmitted||(this.closeEventEmitted=!0,this._debug("Emitting WebSocketConnection close event"),this.emit("close",this.closeReasonCode,this.closeDescription)),this._debug("Drop: destroying socket"),this.socket.destroy()},d.prototype.setCloseTimer=function(){this._debug("setCloseTimer"),this.clearCloseTimer(),this._debug("Setting close timer"),this.waitingForCloseResponse=!0,this.closeTimer=setTimeout(this._closeTimerHandler,this.closeTimeout)},d.prototype.clearCloseTimer=function(){this._debug("clearCloseTimer"),this.closeTimer&&(this._debug("Clearing close timer"),clearTimeout(this.closeTimer),this.waitingForCloseResponse=!1,this.closeTimer=null)},d.prototype.handleCloseTimer=function(){this._debug("handleCloseTimer"),this.closeTimer=null,this.waitingForCloseResponse&&(this._debug("Close response not received from client.  Forcing socket end."),this.waitingForCloseResponse=!1,this.state="closed",this.socket.end())},d.prototype.processFrame=function(e){if(this._debug("processFrame"),this._debug(" -- frame: %s",e),0!==this.frameQueue.length&&e.opcode>0&&e.opcode<8)this.drop(d.CLOSE_REASON_PROTOCOL_ERROR,"Illegal frame opcode 0x"+e.opcode.toString(16)+" received in middle of fragmented message.");else switch(e.opcode){case 2:this._debug("-- Binary Frame"),this.assembleFragments&&(e.fin?(this._debug("---- Emitting 'message' event"),this.emit("message",{type:"binary",binaryData:e.binaryPayload})):(this.frameQueue.push(e),this.fragmentationSize=e.length));break;case 1:if(this._debug("-- Text Frame"),this.assembleFragments)if(e.fin){if(!c.isValidUTF8(e.binaryPayload))return void this.drop(d.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this._debug("---- Emitting 'message' event"),this.emit("message",{type:"utf8",utf8Data:e.binaryPayload.toString("utf8")})}else this.frameQueue.push(e),this.fragmentationSize=e.length;break;case 0:if(this._debug("-- Continuation Frame"),this.assembleFragments){if(0===this.frameQueue.length)return void this.drop(d.CLOSE_REASON_PROTOCOL_ERROR,"Unexpected Continuation Frame");if(this.fragmentationSize+=e.length,this.fragmentationSize>this.maxReceivedMessageSize)return void this.drop(d.CLOSE_REASON_MESSAGE_TOO_BIG,"Maximum message size exceeded.");if(this.frameQueue.push(e),e.fin){var t=0,n=u(this.fragmentationSize),r=this.frameQueue[0].opcode;switch(this.frameQueue.forEach((function(e){e.binaryPayload.copy(n,t),t+=e.binaryPayload.length})),this.frameQueue=[],this.fragmentationSize=0,r){case 2:this.emit("message",{type:"binary",binaryData:n});break;case 1:if(!c.isValidUTF8(n))return void this.drop(d.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this.emit("message",{type:"utf8",utf8Data:n.toString("utf8")});break;default:return void this.drop(d.CLOSE_REASON_PROTOCOL_ERROR,"Unexpected first opcode in fragmentation sequence: 0x"+r.toString(16))}}}break;case 9:if(this._debug("-- Ping Frame"),this._pingListenerCount>0){var o=!1;this.emit("ping",(function(){o=!0}),e.binaryPayload),o||this.pong(e.binaryPayload)}else this.pong(e.binaryPayload);break;case 10:this._debug("-- Pong Frame"),this.emit("pong",e.binaryPayload);break;case 8:if(this._debug("-- Close Frame"),this.waitingForCloseResponse)return this._debug("---- Got close response from peer.  Completing closing handshake."),this.clearCloseTimer(),this.waitingForCloseResponse=!1,this.state="closed",void this.socket.end();var i;if(this._debug("---- Closing handshake initiated by peer."),this.state="peer_requested_close",e.invalidCloseFrameLength?(this.closeReasonCode=1005,i=d.CLOSE_REASON_PROTOCOL_ERROR):-1===e.closeStatus||p(e.closeStatus)?(this.closeReasonCode=e.closeStatus,i=d.CLOSE_REASON_NORMAL):(this.closeReasonCode=e.closeStatus,i=d.CLOSE_REASON_PROTOCOL_ERROR),e.binaryPayload.length>1){if(!c.isValidUTF8(e.binaryPayload))return void this.drop(d.CLOSE_REASON_INVALID_DATA,"Invalid UTF-8 Data Received");this.closeDescription=e.binaryPayload.toString("utf8")}else this.closeDescription=d.CLOSE_DESCRIPTIONS[this.closeReasonCode];this._debug("------ Remote peer %s - code: %d - %s - close frame payload length: %d",this.remoteAddress,this.closeReasonCode,this.closeDescription,e.length),this._debug("------ responding to remote peer's close request."),this.sendCloseFrame(i,null),this.connected=!1;break;default:this._debug("-- Unrecognized Opcode %d",e.opcode),this.drop(d.CLOSE_REASON_PROTOCOL_ERROR,"Unrecognized Opcode: 0x"+e.opcode.toString(16))}},d.prototype.send=function(e,t){if(this._debug("send"),Buffer.isBuffer(e))this.sendBytes(e,t);else{if("function"!=typeof e.toString)throw new Error("Data provided must either be a Node Buffer or implement toString()");this.sendUTF(e,t)}},d.prototype.sendUTF=function(e,t){e=h(e.toString(),"utf8"),this._debug("sendUTF: %d bytes",e.length);var n=new s(this.maskBytes,this.frameHeader,this.config);n.opcode=1,n.binaryPayload=e,this.fragmentAndSend(n,t)},d.prototype.sendBytes=function(e,t){if(this._debug("sendBytes"),!Buffer.isBuffer(e))throw new Error("You must pass a Node Buffer object to WebSocketConnection.prototype.sendBytes()");var n=new s(this.maskBytes,this.frameHeader,this.config);n.opcode=2,n.binaryPayload=e,this.fragmentAndSend(n,t)},d.prototype.ping=function(e){this._debug("ping");var t=new s(this.maskBytes,this.frameHeader,this.config);t.opcode=9,t.fin=!0,e&&(Buffer.isBuffer(e)||(e=h(e.toString(),"utf8")),e.length>125&&(this._debug("WebSocket: Data for ping is longer than 125 bytes.  Truncating."),e=e.slice(0,124)),t.binaryPayload=e),this.sendFrame(t)},d.prototype.pong=function(e){this._debug("pong");var t=new s(this.maskBytes,this.frameHeader,this.config);t.opcode=10,Buffer.isBuffer(e)&&e.length>125&&(this._debug("WebSocket: Data for pong is longer than 125 bytes.  Truncating."),e=e.slice(0,124)),t.binaryPayload=e,t.fin=!0,this.sendFrame(t)},d.prototype.fragmentAndSend=function(e,t){if(this._debug("fragmentAndSend"),e.opcode>7)throw new Error("You cannot fragment control frames.");var n=this.config.fragmentationThreshold,r=e.binaryPayload.length;if(!this.config.fragmentOutgoingMessages||e.binaryPayload&&r<=n)return e.fin=!0,void this.sendFrame(e,t);for(var o=Math.ceil(r/n),i=0,a=function(e){e?"function"==typeof t&&(t(e),t=null):++i===o&&"function"==typeof t&&t()},c=1;c<=o;c++){var u=new s(this.maskBytes,this.frameHeader,this.config);u.opcode=1===c?e.opcode:0,u.fin=c===o;var h=c===o?r-n*(c-1):n,l=n*(c-1);u.binaryPayload=e.binaryPayload.slice(l,l+h),this.sendFrame(u,a)}},d.prototype.sendCloseFrame=function(e,t,n){if("number"!=typeof e&&(e=d.CLOSE_REASON_NORMAL),this._debug("sendCloseFrame state: %s, reasonCode: %d, description: %s",this.state,e,t),"open"===this.state||"peer_requested_close"===this.state){var r=new s(this.maskBytes,this.frameHeader,this.config);r.fin=!0,r.opcode=8,r.closeStatus=e,"string"==typeof t&&(r.binaryPayload=h(t,"utf8")),this.sendFrame(r,n),this.socket.end()}},d.prototype.sendFrame=function(e,t){this._debug("sendFrame"),e.mask=this.maskOutgoingPackets;var n=this.socket.write(e.toBuffer(),t);return this.outputBufferFull=!n,n},e.exports=d},160:function(e,t){e.exports=require("http")},161:function(e,t){e.exports=require("https")},18:function(e,t){e.exports=require("buffer")},195:function(e,t,n){"undefined"!=typeof process&&"renderer"===process.type?e.exports=n(393):e.exports=n(395)},196:function(e,t,n){var r;function o(e){function n(){if(n.enabled){var e=n,o=+new Date,i=o-(r||o);e.diff=i,e.prev=r,e.curr=o,r=o;for(var s=new Array(arguments.length),a=0;a<s.length;a++)s[a]=arguments[a];s[0]=t.coerce(s[0]),"string"!=typeof s[0]&&s.unshift("%O");var c=0;s[0]=s[0].replace(/%([a-zA-Z%])/g,(function(n,r){if("%%"===n)return n;c++;var o=t.formatters[r];if("function"==typeof o){var i=s[c];n=o.call(e,i),s.splice(c,1),c--}return n})),t.formatArgs.call(e,s);var u=n.log||t.log||console.log.bind(console);u.apply(e,s)}}return n.namespace=e,n.enabled=t.enabled(e),n.useColors=t.useColors(),n.color=function(e){var n,r=0;for(n in e)r=(r<<5)-r+e.charCodeAt(n),r|=0;return t.colors[Math.abs(r)%t.colors.length]}(e),"function"==typeof t.init&&t.init(n),n}(t=e.exports=o.debug=o.default=o).coerce=function(e){return e instanceof Error?e.stack||e.message:e},t.disable=function(){t.enable("")},t.enable=function(e){t.save(e),t.names=[],t.skips=[];for(var n=("string"==typeof e?e:"").split(/[\s,]+/),r=n.length,o=0;o<r;o++)n[o]&&("-"===(e=n[o].replace(/\*/g,".*?"))[0]?t.skips.push(new RegExp("^"+e.substr(1)+"$")):t.names.push(new RegExp("^"+e+"$")))},t.enabled=function(e){var n,r;for(n=0,r=t.skips.length;n<r;n++)if(t.skips[n].test(e))return!1;for(n=0,r=t.names.length;n<r;n++)if(t.names[n].test(e))return!0;return!1},t.humanize=n(394),t.names=[],t.skips=[],t.formatters={}},197:function(e,t,n){for(var r=n(3),o=n(51),i=n(108),s=n(50).EventEmitter,a=n(159),c=/,\s*/,u=/;\s*/,h=/[\r\n]/g,l=/,\s*/,f=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"," ",String.fromCharCode(9)],d=[String.fromCharCode(127)],p=0;p<31;p++)d.push(String.fromCharCode(p));var g=/([\x00-\x20\x22\x28\x29\x2c\x2f\x3a-\x3f\x40\x5b-\x5e\x7b\x7d\x7f])/,m=/[^\x21\x23-\x2b\x2d-\x3a\x3c-\x5b\x5d-\x7e]/,v=/^"[^"]*"$/,y=/[\x00-\x20\x3b]/g,b=/[;,] */,_={100:"Continue",101:"Switching Protocols",200:"OK",201:"Created",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",305:"Use Proxy",307:"Temporary Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",406:"Not Acceptable",407:"Proxy Authorization Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Request Entity Too Long",414:"Request-URI Too Long",415:"Unsupported Media Type",416:"Requested Range Not Satisfiable",417:"Expectation Failed",426:"Upgrade Required",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported"};function E(e,t,n){s.call(this),this.socket=e,this.httpRequest=t,this.resource=t.url,this.remoteAddress=e.remoteAddress,this.remoteAddresses=[this.remoteAddress],this.serverConfig=n,this._socketIsClosing=!1,this._socketCloseHandler=this._handleSocketCloseBeforeAccept.bind(this),this.socket.on("end",this._socketCloseHandler),this.socket.on("close",this._socketCloseHandler),this._resolved=!1}function S(e){process.nextTick((function(){e.drop(1006,"TCP connection lost before handshake completed.",!0)}))}o.inherits(E,s),E.prototype.readHandshake=function(){var e=this,t=this.httpRequest;if(this.resourceURL=i.parse(this.resource,!0),this.host=t.headers.host,!this.host)throw new Error("Client must provide a Host header.");if(this.key=t.headers["sec-websocket-key"],!this.key)throw new Error("Client must provide a value for Sec-WebSocket-Key.");if(this.webSocketVersion=parseInt(t.headers["sec-websocket-version"],10),!this.webSocketVersion||isNaN(this.webSocketVersion))throw new Error("Client must provide a value for Sec-WebSocket-Version.");switch(this.webSocketVersion){case 8:case 13:break;default:var n=new Error("Unsupported websocket client version: "+this.webSocketVersion+"Only versions 8 and 13 are supported.");throw n.httpCode=426,n.headers={"Sec-WebSocket-Version":"13"},n}13===this.webSocketVersion?this.origin=t.headers.origin:8===this.webSocketVersion&&(this.origin=t.headers["sec-websocket-origin"]);var r=t.headers["sec-websocket-protocol"];(this.protocolFullCaseMap={},this.requestedProtocols=[],r)&&r.split(c).forEach((function(t){var n=t.toLocaleLowerCase();e.requestedProtocols.push(n),e.protocolFullCaseMap[n]=t}));if(!this.serverConfig.ignoreXForwardedFor&&t.headers["x-forwarded-for"]){var o=this.remoteAddress;this.remoteAddresses=t.headers["x-forwarded-for"].split(l),this.remoteAddresses.push(o),this.remoteAddress=this.remoteAddresses[0]}var s=t.headers["sec-websocket-extensions"];this.requestedExtensions=this.parseExtensions(s);var a=t.headers.cookie;this.cookies=this.parseCookies(a)},E.prototype.parseExtensions=function(e){if(!e||0===e.length)return[];var t=e.toLocaleLowerCase().split(c);return t.forEach((function(e,t,n){var r=e.split(u),o=r[0],i=r.slice(1);i.forEach((function(e,t,n){var r=e.split("="),o={name:r[0],value:r[1]};n.splice(t,1,o)}));var s={name:o,params:i};n.splice(t,1,s)})),t},E.prototype.parseCookies=function(e){if(!e||"string"!=typeof e)return[];var t=[];return e.split(b).forEach((function(e){var n=e.indexOf("=");if(-1!==n){var r=e.substr(0,n).trim(),o=e.substr(++n,e.length).trim();'"'===o[0]&&(o=o.slice(1,-1)),t.push({name:r,value:decodeURIComponent(o)})}else t.push({name:e,value:null})})),t},E.prototype.accept=function(e,t,n){var o;this._verifyResolution(),e?void 0===(o=this.protocolFullCaseMap[e.toLocaleLowerCase()])&&(o=e):o=e,this.protocolFullCaseMap=null;var i=r.createHash("sha1");i.update(this.key+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var s="HTTP/1.1 101 Switching Protocols\r\nUpgrade: websocket\r\nConnection: Upgrade\r\nSec-WebSocket-Accept: "+i.digest("base64")+"\r\n";if(o){for(var c=0;c<o.length;c++){var u=o.charCodeAt(c),l=o.charAt(c);if(u<33||u>126||-1!==f.indexOf(l))throw this.reject(500),new Error('Illegal character "'+String.fromCharCode(l)+'" in subprotocol.')}if(-1===this.requestedProtocols.indexOf(e))throw this.reject(500),new Error("Specified protocol was not requested by the client.");o=o.replace(h,""),s+="Sec-WebSocket-Protocol: "+o+"\r\n"}if(this.requestedProtocols=null,t&&(t=t.replace(h,""),13===this.webSocketVersion?s+="Origin: "+t+"\r\n":8===this.webSocketVersion&&(s+="Sec-WebSocket-Origin: "+t+"\r\n")),n){if(!Array.isArray(n))throw this.reject(500),new Error('Value supplied for "cookies" argument must be an array.');var d={};n.forEach(function(e){if(!e.name||!e.value)throw this.reject(500),new Error('Each cookie to set must at least provide a "name" and "value"');if(e.name=e.name.replace(y,""),e.value=e.value.replace(y,""),d[e.name])throw this.reject(500),new Error("You may not specify the same cookie name twice.");d[e.name]=!0;var t=e.name.match(g);if(t)throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie name");if(t=e.value.match(v)?e.value.slice(1,-1).match(m):e.value.match(m))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie value");var n=[e.name+"="+e.value];if(e.path){if(t=e.path.match(y))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie path");n.push("Path="+e.path)}if(e.domain){if("string"!=typeof e.domain)throw this.reject(500),new Error("Domain must be specified and must be a string.");if(t=e.domain.match(y))throw this.reject(500),new Error("Illegal character "+t[0]+" in cookie domain");n.push("Domain="+e.domain.toLowerCase())}if(e.expires){if(!(e.expires instanceof Date))throw this.reject(500),new Error('Value supplied for cookie "expires" must be a vaild date object');n.push("Expires="+e.expires.toGMTString())}if(e.maxage){var r=e.maxage;if("string"==typeof r&&(r=parseInt(r,10)),isNaN(r)||r<=0)throw this.reject(500),new Error('Value supplied for cookie "maxage" must be a non-zero number');r=Math.round(r),n.push("Max-Age="+r.toString(10))}if(e.secure){if("boolean"!=typeof e.secure)throw this.reject(500),new Error('Value supplied for cookie "secure" must be of type boolean');n.push("Secure")}if(e.httponly){if("boolean"!=typeof e.httponly)throw this.reject(500),new Error('Value supplied for cookie "httponly" must be of type boolean');n.push("HttpOnly")}s+="Set-Cookie: "+n.join(";")+"\r\n"}.bind(this))}this._resolved=!0,this.emit("requestResolved",this),s+="\r\n";var p=new a(this.socket,[],e,!1,this.serverConfig);p.webSocketVersion=this.webSocketVersion,p.remoteAddress=this.remoteAddress,p.remoteAddresses=this.remoteAddresses;var b=this;return this._socketIsClosing?S(p):this.socket.write(s,"ascii",(function(e){e?S(p):(b._removeSocketCloseListeners(),p._addSocketEventListeners())})),this.emit("requestAccepted",p),p},E.prototype.reject=function(e,t,n){this._verifyResolution(),this._resolved=!0,this.emit("requestResolved",this),"number"!=typeof e&&(e=403);var r="HTTP/1.1 "+e+" "+_[e]+"\r\nConnection: close\r\n";if(t&&(r+="X-WebSocket-Reject-Reason: "+(t=t.replace(h,""))+"\r\n"),n)for(var o in n){var i=n[o].toString().replace(h,"");r+=o.replace(h,"")+": "+i+"\r\n"}r+="\r\n",this.socket.end(r,"ascii"),this.emit("requestRejected",this)},E.prototype._handleSocketCloseBeforeAccept=function(){this._socketIsClosing=!0,this._removeSocketCloseListeners()},E.prototype._removeSocketCloseListeners=function(){this.socket.removeListener("end",this._socketCloseHandler),this.socket.removeListener("close",this._socketCloseHandler)},E.prototype._verifyResolution=function(){if(this._resolved)throw new Error("WebSocketRequest may only be accepted or rejected one time.")},e.exports=E},198:function(e,t,n){var r=n(398).BufferUtil,o=n(76).bufferAllocUnsafe;function i(e,t,n){this.maskBytes=e,this.frameHeader=t,this.config=n,this.maxReceivedFrameSize=n.maxReceivedFrameSize,this.protocolError=!1,this.frameTooLarge=!1,this.invalidCloseFrameLength=!1,this.parseState=1,this.closeStatus=-1}i.prototype.addData=function(e){if(1===this.parseState&&e.length>=2){e.joinInto(this.frameHeader,0,0,2),e.advance(2);var t=this.frameHeader[0],n=this.frameHeader[1];if(this.fin=Boolean(128&t),this.rsv1=Boolean(64&t),this.rsv2=Boolean(32&t),this.rsv3=Boolean(16&t),this.mask=Boolean(128&n),this.opcode=15&t,this.length=127&n,this.opcode>=8){if(this.length>125)return this.protocolError=!0,this.dropReason="Illegal control frame longer than 125 bytes.",!0;if(!this.fin)return this.protocolError=!0,this.dropReason="Control frames must not be fragmented.",!0}126===this.length?this.parseState=2:127===this.length?this.parseState=3:this.parseState=4}if(2===this.parseState)e.length>=2&&(e.joinInto(this.frameHeader,2,0,2),e.advance(2),this.length=this.frameHeader.readUInt16BE(2),this.parseState=4);else if(3===this.parseState&&e.length>=8){e.joinInto(this.frameHeader,2,0,8),e.advance(8);var i=[this.frameHeader.readUInt32BE(2),this.frameHeader.readUInt32BE(6)];if(0!==i[0])return this.protocolError=!0,this.dropReason="Unsupported 64-bit length frame received",!0;this.length=i[1],this.parseState=4}if(4===this.parseState&&(this.mask?e.length>=4&&(e.joinInto(this.maskBytes,0,0,4),e.advance(4),this.parseState=5):this.parseState=5),5===this.parseState){if(this.length>this.maxReceivedFrameSize)return this.frameTooLarge=!0,this.dropReason="Frame size of "+this.length.toString(10)+" bytes exceeds maximum accepted frame size",!0;if(0===this.length)return this.binaryPayload=o(0),this.parseState=6,!0;if(e.length>=this.length)return this.binaryPayload=e.take(this.length),e.advance(this.length),this.mask&&r.unmask(this.binaryPayload,this.maskBytes),8===this.opcode&&(1===this.length&&(this.binaryPayload=o(0),this.invalidCloseFrameLength=!0),this.length>=2&&(this.closeStatus=this.binaryPayload.readUInt16BE(0),this.binaryPayload=this.binaryPayload.slice(2))),this.parseState=6,!0}return!1},i.prototype.throwAwayPayload=function(e){return e.length>=this.length&&(e.advance(this.length),this.parseState=6,!0)},i.prototype.toBuffer=function(e){var t,n,i,s=2,a=0,c=0;this.fin&&(a|=128),this.rsv1&&(a|=64),this.rsv2&&(a|=32),this.rsv3&&(a|=16),this.mask&&(c|=128),a|=15&this.opcode,8===this.opcode?(this.length=2,this.binaryPayload&&(this.length+=this.binaryPayload.length),(n=o(this.length)).writeUInt16BE(this.closeStatus,0),this.length>2&&this.binaryPayload.copy(n,2)):this.binaryPayload?(n=this.binaryPayload,this.length=n.length):this.length=0,this.length<=125?c|=127&this.length:this.length>125&&this.length<=65535?(c|=126,s+=2):this.length>65535&&(c|=127,s+=8);var u=o(this.length+s+(this.mask?4:0));return u[0]=a,u[1]=c,i=2,this.length>125&&this.length<=65535?(u.writeUInt16BE(this.length,i),i+=2):this.length>65535&&(u.writeUInt32BE(0,i),u.writeUInt32BE(this.length,i+4),i+=8),this.mask?(t=e?0:4294967295*Math.random()>>>0,this.maskBytes.writeUInt32BE(t,0),this.maskBytes.copy(u,i),i+=4,n&&r.mask(n,this.maskBytes,u,i,this.length)):n&&n.copy(u,i),u},i.prototype.toString=function(){return"Opcode: "+this.opcode+", fin: "+this.fin+", length: "+this.length+", hasPayload: "+Boolean(this.binaryPayload)+", masked: "+this.mask},e.exports=i},199:function(e,t,n){var r=n(76),o=r.extend,i=n(51),s=n(50).EventEmitter,a=n(160),c=n(161),u=n(108),h=n(3),l=n(159),f=r.bufferAllocUnsafe,d=["(",")","<",">","@",",",";",":","\\",'"',"/","[","]","?","=","{","}"," ",String.fromCharCode(9)],p=["hostname","port","method","path","headers"];function g(e){var t;(s.call(this),this.config={maxReceivedFrameSize:1048576,maxReceivedMessageSize:8388608,fragmentOutgoingMessages:!0,fragmentationThreshold:16384,webSocketVersion:13,assembleFragments:!0,disableNagleAlgorithm:!0,closeTimeout:5e3,tlsOptions:{}},e)&&(e.tlsOptions?(t=e.tlsOptions,delete e.tlsOptions):t={},o(this.config,e),o(this.config.tlsOptions,t));switch(this._req=null,this.config.webSocketVersion){case 8:case 13:break;default:throw new Error("Requested webSocketVersion is not supported. Allowed values are 8 and 13.")}}i.inherits(g,s),g.prototype.connect=function(e,t,n,i,s){var h=this;if("string"==typeof t&&(t=t.length>0?[t]:[]),t instanceof Array||(t=[]),this.protocols=t,this.origin=n,this.url="string"==typeof e?u.parse(e):e,!this.url.protocol)throw new Error("You must specify a full WebSocket URL, including protocol.");if(!this.url.host)throw new Error("You must specify a full WebSocket URL, including hostname. Relative URLs are not supported.");this.secure="wss:"===this.url.protocol,this.protocols.forEach((function(e){for(var t=0;t<e.length;t++){var n=e.charCodeAt(t),r=e.charAt(t);if(n<33||n>126||-1!==d.indexOf(r))throw new Error('Protocol list contains invalid character "'+String.fromCharCode(n)+'"')}}));this.url.port||(this.url.port={"ws:":"80","wss:":"443"}[this.url.protocol]);for(var l=f(16),g=0;g<16;g++)l[g]=Math.round(255*Math.random());this.base64nonce=l.toString("base64");var m=this.url.hostname;("ws:"===this.url.protocol&&"80"!==this.url.port||"wss:"===this.url.protocol&&"443"!==this.url.port)&&(m+=":"+this.url.port);var v,y={};function b(e){h._req=null,h.emit("connectFailed",e)}this.secure&&this.config.tlsOptions.hasOwnProperty("headers")&&o(y,this.config.tlsOptions.headers),i&&o(y,i),o(y,{Upgrade:"websocket",Connection:"Upgrade","Sec-WebSocket-Version":this.config.webSocketVersion.toString(10),"Sec-WebSocket-Key":this.base64nonce,Host:y.Host||m}),this.protocols.length>0&&(y["Sec-WebSocket-Protocol"]=this.protocols.join(", ")),this.origin&&(13===this.config.webSocketVersion?y.Origin=this.origin:8===this.config.webSocketVersion&&(y["Sec-WebSocket-Origin"]=this.origin)),v=this.url.pathname?this.url.path:this.url.path?"/"+this.url.path:"/";var _={agent:!1};if(s&&o(_,s),o(_,{hostname:this.url.hostname,port:this.url.port,method:"GET",path:v,headers:y}),this.secure){var E=this.config.tlsOptions;for(var S in E)E.hasOwnProperty(S)&&-1===p.indexOf(S)&&(_[S]=E[S])}var k=this._req=(this.secure?c:a).request(_);k.on("upgrade",(function(e,t,n){h._req=null,k.removeListener("error",b),h.socket=t,h.response=e,h.firstDataChunk=n,h.validateHandshake()})),k.on("error",b),k.on("response",(function(e){if(h._req=null,r.eventEmitterListenerCount(h,"httpResponse")>0)h.emit("httpResponse",e,h),e.socket&&e.socket.end();else{var t=[];for(var n in e.headers)t.push(n+": "+e.headers[n]);h.failHandshake("Server responded with a non-101 status: "+e.statusCode+" "+e.statusMessage+"\nResponse Headers Follow:\n"+t.join("\n")+"\n")}})),k.end()},g.prototype.validateHandshake=function(){var e=this.response.headers;if(this.protocols.length>0){if(this.protocol=e["sec-websocket-protocol"],!this.protocol)return void this.failHandshake("Expected a Sec-WebSocket-Protocol header.");if(-1===this.protocols.indexOf(this.protocol))return void this.failHandshake("Server did not respond with a requested protocol.")}if(e.connection&&"upgrade"===e.connection.toLocaleLowerCase())if(e.upgrade&&"websocket"===e.upgrade.toLocaleLowerCase()){var t=h.createHash("sha1");t.update(this.base64nonce+"258EAFA5-E914-47DA-95CA-C5AB0DC85B11");var n=t.digest("base64");e["sec-websocket-accept"]?e["sec-websocket-accept"]===n?this.succeedHandshake():this.failHandshake("Sec-WebSocket-Accept header from server didn't match expected value of "+n):this.failHandshake("Expected Sec-WebSocket-Accept header from server")}else this.failHandshake("Expected an Upgrade: websocket header from the server");else this.failHandshake("Expected a Connection: Upgrade header from the server")},g.prototype.failHandshake=function(e){this.socket&&this.socket.writable&&this.socket.end(),this.emit("connectFailed",new Error(e))},g.prototype.succeedHandshake=function(){var e=new l(this.socket,[],this.protocol,!0,this.config);e.webSocketVersion=this.config.webSocketVersion,e._addSocketEventListeners(),this.emit("connect",e),this.firstDataChunk.length>0&&e.handleSocketData(this.firstDataChunk),this.firstDataChunk=null},g.prototype.abort=function(){this._req&&this._req.abort()},e.exports=g},3:function(e,t){e.exports=require("crypto")},30:function(e,t,n){"use strict";var r={CONNECT:function(e){return new Error("CONNECTION ERROR: Couldn't connect to node ".concat(e,"."))},ABORT:function(){return new Error("ABORT ERROR: Request already aborted.")},PARAMS:function(){return new Error("PARAMS ERROR.")},TIMEOUT:function(e){return new Error("CONNECTION TIMEOUT: timeout of ".concat(e," ms achived"))},INVAILID_RESPONSE:function(e){return new Error("Invalid JSON RPC response: ".concat(JSON.stringify(e)))},IPC_ON:function(e){return new Error("Invalid IPC event on: ".concat(JSON.stringify(e)))},IPC_ON_CB:function(e){return new Error("The IPC on event ".concat(JSON.stringify(e),", cb is necessary"))}};function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}var i=n(57),s=function(){function e(){!function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,e),this.ERRORS=r,this.jsonrpc=i,this._requestManager=[],this._requestId=0}var t,n,s;return t=e,(n=[{key:"abort",value:function(){var e=this;this._requestManager.forEach((function(t){var n=t.request,r=t.rej;n.abort(),r(e.ERRORS.ABORT())})),this._requestManager=[]}},{key:"_addReq",value:function(e){var t={request:e.request,rej:e.rej};return this._requestManager.push(t),t}},{key:"_removeReq",value:function(e){for(var t=0;t<this._requestManager.length;t++)if(this._requestManager[t]===e){this._requestManager.splice(t,1);break}}},{key:"_getRequestPayload",value:function(e,t){return e?(this._requestId++,this.jsonrpc.request(this._requestId,e,t)):r.PARAMS()}},{key:"_getNotificationPayload",value:function(e,t){return e?this.jsonrpc.notification(e,t):r.PARAMS()}},{key:"_getBatchPayload",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[];if(!e||!e.length)return r.PARAMS();for(var t=[],n=0;n<e.length;n++){var o=e[n];if(!o||!o.type||"request"!==o.type&&"notification"!==o.type)return r.PARAMS();var i="notification"===o.type?this._getNotificationPayload(o.methodName,o.params):this._getRequestPayload(o.methodName,o.params);if(i instanceof Error)return i;t.push(i)}return t}}])&&o(t.prototype,n),s&&o(t,s),e}();t.a=s},389:function(e,t,n){"use strict";n.r(t),n.d(t,"WS_RPC",(function(){return f}));var r=n(52);function o(e){return(o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function i(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function s(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function a(e,t){return(a=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function c(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=h(e);if(t){var o=h(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return u(this,n)}}function u(e,t){return!t||"object"!==o(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function h(e){return(h=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var l=n(390).w3cwebsocket,f=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&a(e,t)}(u,e);var t,n,r,o=c(u);function u(){var e,t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"ws://localhost:31420",n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:6e4,r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{protocol:"",headers:"",clientConfig:"",retryTimes:10,retryInterval:1e4};if(i(this,u),e=o.call(this,{onEventTypes:["error","close","connect"],sendFuncName:"send",path:t}),!t)throw e.ERRORS.CONNECT(t);e.timeout=n,e.protocol=r.protocol,e.headers=r.headers,e.clientConfig=r.clientConfig,e._timeout=null,e._destroyed=!1,e.reconnect();var s=0;return e.on("connect",(function(){s=0})),e.on("close",(function(){s>r.retryTimes||(e._timeout=setTimeout((function(){s++,e.reconnect()}),r.retryInterval))})),e}return t=u,(n=[{key:"reconnect",value:function(){var e=this;this._destroyed||(this.disconnect(),this.socket=new l(this.path,this.protocol,null,this.headers,null,this.clientConfig),this.socket.onopen=function(){e.socket.readyState===e.socket.OPEN&&e._connected()},this.socket.onclose=function(){e._closed()},this.socket.onerror=function(t){e._errored(t)},this.socket.onmessage=function(t){var n="string"==typeof t.data?t.data:"";e._parse([n])})}},{key:"disconnect",value:function(){this.socket&&this.socket.close&&this.socket.close(),clearTimeout(this._timeout),this.socket=null}},{key:"destroy",value:function(){this.disconnect(),this.remove("error"),this.remove("close"),this.remove("connect"),this._destroyed=!0}}])&&s(t.prototype,n),r&&s(t,r),u}(r.a);t.default=f},390:function(e,t,n){e.exports=n(391)},391:function(e,t,n){e.exports={server:n(392),client:n(199),router:n(403),frame:n(198),request:n(197),connection:n(159),w3cwebsocket:n(405),deprecation:n(411),version:n(412)}},392:function(e,t,n){var r=n(76).extend,o=n(76),i=n(51),s=n(195)("websocket:server"),a=n(50).EventEmitter,c=n(197),u=function(e){a.call(this),this._handlers={upgrade:this.handleUpgrade.bind(this),requestAccepted:this.handleRequestAccepted.bind(this),requestResolved:this.handleRequestResolved.bind(this)},this.connections=[],this.pendingRequests=[],e&&this.mount(e)};i.inherits(u,a),u.prototype.mount=function(e){if(this.config={httpServer:null,maxReceivedFrameSize:65536,maxReceivedMessageSize:1048576,fragmentOutgoingMessages:!0,fragmentationThreshold:16384,keepalive:!0,keepaliveInterval:2e4,dropConnectionOnKeepaliveTimeout:!0,keepaliveGracePeriod:1e4,useNativeKeepalive:!1,assembleFragments:!0,autoAcceptConnections:!1,ignoreXForwardedFor:!1,disableNagleAlgorithm:!0,closeTimeout:5e3},r(this.config,e),!this.config.httpServer)throw new Error("You must specify an httpServer on which to mount the WebSocket server.");Array.isArray(this.config.httpServer)||(this.config.httpServer=[this.config.httpServer]);var t=this._handlers.upgrade;this.config.httpServer.forEach((function(e){e.on("upgrade",t)}))},u.prototype.unmount=function(){var e=this._handlers.upgrade;this.config.httpServer.forEach((function(t){t.removeListener("upgrade",e)}))},u.prototype.closeAllConnections=function(){this.connections.forEach((function(e){e.close()})),this.pendingRequests.forEach((function(e){process.nextTick((function(){e.reject(503)}))}))},u.prototype.broadcast=function(e){Buffer.isBuffer(e)?this.broadcastBytes(e):"function"==typeof e.toString&&this.broadcastUTF(e)},u.prototype.broadcastUTF=function(e){this.connections.forEach((function(t){t.sendUTF(e)}))},u.prototype.broadcastBytes=function(e){this.connections.forEach((function(t){t.sendBytes(e)}))},u.prototype.shutDown=function(){this.unmount(),this.closeAllConnections()},u.prototype.handleUpgrade=function(e,t){var n=this,r=new c(t,e,this.config);try{r.readHandshake()}catch(e){return r.reject(e.httpCode?e.httpCode:400,e.message,e.headers),void s("Invalid handshake: %s",e.message)}this.pendingRequests.push(r),r.once("requestAccepted",this._handlers.requestAccepted),r.once("requestResolved",this._handlers.requestResolved),t.once("close",(function(){n._handlers.requestResolved(r)})),!this.config.autoAcceptConnections&&o.eventEmitterListenerCount(this,"request")>0?this.emit("request",r):this.config.autoAcceptConnections?r.accept(r.requestedProtocols[0],r.origin):r.reject(404,"No handler is configured to accept the connection.")},u.prototype.handleRequestAccepted=function(e){var t=this;e.once("close",(function(n,r){t.handleConnectionClose(e,n,r)})),this.connections.push(e),this.emit("connect",e)},u.prototype.handleConnectionClose=function(e,t,n){var r=this.connections.indexOf(e);-1!==r&&this.connections.splice(r,1),this.emit("close",e,t,n)},u.prototype.handleRequestResolved=function(e){var t=this.pendingRequests.indexOf(e);-1!==t&&this.pendingRequests.splice(t,1)},e.exports=u},393:function(e,t,n){function r(){var e;try{e=t.storage.debug}catch(e){}return!e&&"undefined"!=typeof process&&"env"in process&&(e=process.env.DEBUG),e}(t=e.exports=n(196)).log=function(){return"object"==typeof console&&console.log&&Function.prototype.apply.call(console.log,console,arguments)},t.formatArgs=function(e){var n=this.useColors;if(e[0]=(n?"%c":"")+this.namespace+(n?" %c":" ")+e[0]+(n?"%c ":" ")+"+"+t.humanize(this.diff),!n)return;var r="color: "+this.color;e.splice(1,0,r,"color: inherit");var o=0,i=0;e[0].replace(/%[a-zA-Z%]/g,(function(e){"%%"!==e&&(o++,"%c"===e&&(i=o))})),e.splice(i,0,r)},t.save=function(e){try{null==e?t.storage.removeItem("debug"):t.storage.debug=e}catch(e){}},t.load=r,t.useColors=function(){if("undefined"!=typeof window&&window.process&&"renderer"===window.process.type)return!0;return"undefined"!=typeof document&&document.documentElement&&document.documentElement.style&&document.documentElement.style.WebkitAppearance||"undefined"!=typeof window&&window.console&&(window.console.firebug||window.console.exception&&window.console.table)||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/firefox\/(\d+)/)&&parseInt(RegExp.$1,10)>=31||"undefined"!=typeof navigator&&navigator.userAgent&&navigator.userAgent.toLowerCase().match(/applewebkit\/(\d+)/)},t.storage="undefined"!=typeof chrome&&void 0!==chrome.storage?chrome.storage.local:function(){try{return window.localStorage}catch(e){}}(),t.colors=["lightseagreen","forestgreen","goldenrod","dodgerblue","darkorchid","crimson"],t.formatters.j=function(e){try{return JSON.stringify(e)}catch(e){return"[UnexpectedJSONParseError]: "+e.message}},t.enable(r())},394:function(e,t){var n=1e3,r=6e4,o=60*r,i=24*o;function s(e,t,n){if(!(e<t))return e<1.5*t?Math.floor(e/t)+" "+n:Math.ceil(e/t)+" "+n+"s"}e.exports=function(e,t){t=t||{};var a,c=typeof e;if("string"===c&&e.length>0)return function(e){if((e=String(e)).length>100)return;var t=/^((?:\d+)?\.?\d+) *(milliseconds?|msecs?|ms|seconds?|secs?|s|minutes?|mins?|m|hours?|hrs?|h|days?|d|years?|yrs?|y)?$/i.exec(e);if(!t)return;var s=parseFloat(t[1]);switch((t[2]||"ms").toLowerCase()){case"years":case"year":case"yrs":case"yr":case"y":return 315576e5*s;case"days":case"day":case"d":return s*i;case"hours":case"hour":case"hrs":case"hr":case"h":return s*o;case"minutes":case"minute":case"mins":case"min":case"m":return s*r;case"seconds":case"second":case"secs":case"sec":case"s":return s*n;case"milliseconds":case"millisecond":case"msecs":case"msec":case"ms":return s;default:return}}(e);if("number"===c&&!1===isNaN(e))return t.long?s(a=e,i,"day")||s(a,o,"hour")||s(a,r,"minute")||s(a,n,"second")||a+" ms":function(e){if(e>=i)return Math.round(e/i)+"d";if(e>=o)return Math.round(e/o)+"h";if(e>=r)return Math.round(e/r)+"m";if(e>=n)return Math.round(e/n)+"s";return e+"ms"}(e);throw new Error("val is not a non-empty string or a valid number. val="+JSON.stringify(e))}},395:function(e,t,n){var r=n(396),o=n(51);(t=e.exports=n(196)).init=function(e){e.inspectOpts={};for(var n=Object.keys(t.inspectOpts),r=0;r<n.length;r++)e.inspectOpts[n[r]]=t.inspectOpts[n[r]]},t.log=function(){return s.write(o.format.apply(o,arguments)+"\n")},t.formatArgs=function(e){var n=this.namespace;if(this.useColors){var r=this.color,o="  [3"+r+";1m"+n+" [0m";e[0]=o+e[0].split("\n").join("\n"+o),e.push("[3"+r+"m+"+t.humanize(this.diff)+"[0m")}else e[0]=(new Date).toUTCString()+" "+n+" "+e[0]},t.save=function(e){null==e?delete process.env.DEBUG:process.env.DEBUG=e},t.load=a,t.useColors=function(){return"colors"in t.inspectOpts?Boolean(t.inspectOpts.colors):r.isatty(i)},t.colors=[6,2,3,4,5,1],t.inspectOpts=Object.keys(process.env).filter((function(e){return/^debug_/i.test(e)})).reduce((function(e,t){var n=t.substring(6).toLowerCase().replace(/_([a-z])/g,(function(e,t){return t.toUpperCase()})),r=process.env[t];return r=!!/^(yes|on|true|enabled)$/i.test(r)||!/^(no|off|false|disabled)$/i.test(r)&&("null"===r?null:Number(r)),e[n]=r,e}),{});var i=parseInt(process.env.DEBUG_FD,10)||2;1!==i&&2!==i&&o.deprecate((function(){}),"except for stderr(2) and stdout(1), any other usage of DEBUG_FD is deprecated. Override debug.log if you want to use a different log function (https://git.io/debug_fd)")();var s=1===i?process.stdout:2===i?process.stderr:function(e){var t;switch(process.binding("tty_wrap").guessHandleType(e)){case"TTY":(t=new r.WriteStream(e))._type="tty",t._handle&&t._handle.unref&&t._handle.unref();break;case"FILE":var o=n(397);(t=new o.SyncWriteStream(e,{autoClose:!1}))._type="fs";break;case"PIPE":case"TCP":var i=n(158);(t=new i.Socket({fd:e,readable:!1,writable:!0})).readable=!1,t.read=null,t._type="pipe",t._handle&&t._handle.unref&&t._handle.unref();break;default:throw new Error("Implement me. Unknown stream file type!")}return t.fd=e,t._isStdio=!0,t}(i);function a(){return process.env.DEBUG}t.formatters.o=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts).split("\n").map((function(e){return e.trim()})).join(" ")},t.formatters.O=function(e){return this.inspectOpts.colors=this.useColors,o.inspect(e,this.inspectOpts)},t.enable(a())},396:function(e,t){e.exports=require("tty")},397:function(e,t){e.exports=require("fs")},398:function(e,t,n){
/*!
 * Copied from:
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
try{e.exports=n(!function(){var e=new Error("Cannot find module '../build/Release/bufferutil'");throw e.code="MODULE_NOT_FOUND",e}())}catch(t){try{e.exports=n(!function(){var e=new Error("Cannot find module '../build/default/bufferutil'");throw e.code="MODULE_NOT_FOUND",e}())}catch(t){try{e.exports=n(399)}catch(e){throw console.error("bufferutil.node seems to not have been built. Run npm install."),e}}}},399:function(e,t){
/*!
 * Copied from:
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
e.exports.BufferUtil={merge:function(e,t){for(var n=0,r=0,o=t.length;r<o;++r){var i=t[r];i.copy(e,n),n+=i.length}},mask:function(e,t,n,r,o){for(var i=t.readUInt32LE(0),s=0;s<o-3;s+=4){var a=i^e.readUInt32LE(s);a<0&&(a=4294967296+a),n.writeUInt32LE(a,r+s)}switch(o%4){case 3:n[r+s+2]=e[s+2]^t[2];case 2:n[r+s+1]=e[s+1]^t[1];case 1:n[r+s]=e[s]^t[0]}},unmask:function(e,t){for(var n=t.readUInt32LE(0),r=e.length,o=0;o<r-3;o+=4){var i=n^e.readUInt32LE(o);i<0&&(i=4294967296+i),e.writeUInt32LE(i,o)}switch(r%4){case 3:e[o+2]=e[o+2]^t[2];case 2:e[o+1]=e[o+1]^t[1];case 1:e[o]=e[o]^t[0]}}}},400:function(e,t,n){var r=n(18).Buffer,o=n(50).EventEmitter,i=n(76).bufferAllocUnsafe;function s(e){if(!(this instanceof s))return new s(e);o.call(this);var t=this;void 0===e&&(e={}),t.encoding=e.encoding;var n={next:null,buffer:null},a={next:null,buffer:null},c=0;t.__defineGetter__("length",(function(){return c}));var u=0;t.write=function(e){return n.buffer?(a.next={next:null,buffer:e},a=a.next):(n.buffer=e,a=n),c+=e.length,t.emit("write",e),!0},t.end=function(e){r.isBuffer(e)&&t.write(e)},t.push=function(){var e=[].concat.apply([],arguments);return e.forEach(t.write),t},t.forEach=function(e){if(!n.buffer)return i(0);if(n.buffer.length-u<=0)return t;for(var r={buffer:n.buffer.slice(u),next:n.next};r&&r.buffer;){if(e(r.buffer))break;r=r.next}return t},t.join=function(e,r){if(!n.buffer)return i(0);null==e&&(e=0),null==r&&(r=t.length);var o=i(r-e),s=0;return t.forEach((function(t){if(e<s+t.length&&s<r&&t.copy(o,Math.max(0,s-e),Math.max(0,e-s),Math.min(t.length,r-s)),(s+=t.length)>r)return!0})),o},t.joinInto=function(e,r,o,s){if(!n.buffer)return new i(0);null==o&&(o=0),null==s&&(s=t.length);var a=e;if(a.length-r<s-o)throw new Error("Insufficient space available in target Buffer.");var c=0;return t.forEach((function(e){if(o<c+e.length&&c<s&&e.copy(a,Math.max(r,r+c-o),Math.max(0,o-c),Math.min(e.length,s-c)),(c+=e.length)>s)return!0})),a},t.advance=function(e){for(u+=e,c-=e;n.buffer&&u>=n.buffer.length;)u-=n.buffer.length,n=n.next?n.next:{buffer:null,next:null};return null===n.buffer&&(a={next:null,buffer:null}),t.emit("advance",e),t},t.take=function(e,n){null==e?e=t.length:"number"!=typeof e&&(n=e,e=t.length);if(n||(n=t.encoding),n){var r="";return t.forEach((function(t){if(e<=0)return!0;r+=t.toString(n,0,Math.min(e,t.length)),e-=t.length})),r}return t.join(0,e)},t.toString=function(){return t.take("binary")}}e.exports=s,e.exports.BufferList=s,n(51).inherits(s,o)},401:function(e,t,n){
/*!
 * UTF-8 Validation Code originally from:
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
try{e.exports=n(!function(){var e=new Error("Cannot find module '../build/Release/validation'");throw e.code="MODULE_NOT_FOUND",e}())}catch(t){try{e.exports=n(!function(){var e=new Error("Cannot find module '../build/default/validation'");throw e.code="MODULE_NOT_FOUND",e}())}catch(t){try{e.exports=n(402)}catch(e){throw console.error("validation.node seems not to have been built. Run npm install."),e}}}},402:function(e,t){
/*!
 * UTF-8 Validation Fallback Code originally from:
 * ws: a node.js websocket client
 * Copyright(c) 2011 Einar Otto Stangvik <einaros@gmail.com>
 * MIT Licensed
 */
e.exports.Validation={isValidUTF8:function(){return!0}}},403:function(e,t,n){var r=n(76).extend,o=n(51),i=n(50).EventEmitter,s=n(404);function a(e){i.call(this),this.config={server:null},e&&r(this.config,e),this.handlers=[],this._requestHandler=this.handleRequest.bind(this),this.config.server&&this.attachServer(this.config.server)}o.inherits(a,i),a.prototype.attachServer=function(e){if(!e)throw new Error("You must specify a WebSocketServer instance to attach to.");this.server=e,this.server.on("request",this._requestHandler)},a.prototype.detachServer=function(){if(!this.server)throw new Error("Cannot detach from server: not attached.");this.server.removeListener("request",this._requestHandler),this.server=null},a.prototype.mount=function(e,t,n){if(!e)throw new Error("You must specify a path for this handler.");if(t||(t="____no_protocol____"),!n)throw new Error("You must specify a callback for this handler.");if(!((e=this.pathToRegExp(e))instanceof RegExp))throw new Error("Path must be specified as either a string or a RegExp.");var r=e.toString();if(t=t.toLocaleLowerCase(),-1!==this.findHandlerIndex(r,t))throw new Error("You may only mount one handler per path/protocol combination.");this.handlers.push({path:e,pathString:r,protocol:t,callback:n})},a.prototype.unmount=function(e,t){var n=this.findHandlerIndex(this.pathToRegExp(e).toString(),t);if(-1===n)throw new Error("Unable to find a route matching the specified path and protocol.");this.handlers.splice(n,1)},a.prototype.findHandlerIndex=function(e,t){t=t.toLocaleLowerCase();for(var n=0,r=this.handlers.length;n<r;n++){var o=this.handlers[n];if(o.pathString===e&&o.protocol===t)return n}return-1},a.prototype.pathToRegExp=function(e){return"string"==typeof e&&("*"===e?e=/^.*$/:(e=e.replace(/[-[\]{}()*+?.,\\^$|#\s]/g,"\\$&"),e=new RegExp("^"+e+"$"))),e},a.prototype.handleRequest=function(e){var t=e.requestedProtocols;0===t.length&&(t=["____no_protocol____"]);for(var n=0;n<t.length;n++)for(var r=t[n].toLocaleLowerCase(),o=0,i=this.handlers.length;o<i;o++){var a=this.handlers[o];if(a.path.test(e.resourceURL.pathname)&&(r===a.protocol||"*"===a.protocol)){var c=new s(e,r);return void a.callback(c)}}e.reject(404,"No handler is available for the given request.")},e.exports=a},404:function(e,t,n){var r=n(51),o=n(50).EventEmitter;function i(e,t){o.call(this),this.webSocketRequest=e,this.protocol="____no_protocol____"===t?null:t,this.origin=e.origin,this.resource=e.resource,this.resourceURL=e.resourceURL,this.httpRequest=e.httpRequest,this.remoteAddress=e.remoteAddress,this.webSocketVersion=e.webSocketVersion,this.requestedExtensions=e.requestedExtensions,this.cookies=e.cookies}r.inherits(i,o),i.prototype.accept=function(e,t){var n=this.webSocketRequest.accept(this.protocol,e,t);return this.emit("requestAccepted",n),n},i.prototype.reject=function(e,t,n){this.webSocketRequest.reject(e,t,n),this.emit("requestRejected",this)},e.exports=i},405:function(e,t,n){var r=n(199),o=n(406),i=n(408);const s=0,a=1,c=2,u=3;function h(e,t,n,o,a,c){i.EventTarget.call(this),(c=c||{}).assembleFragments=!0;var u=this;this._url=e,this._readyState=s,this._protocol=void 0,this._extensions="",this._bufferedAmount=0,this._binaryType="arraybuffer",this._connection=void 0,this._client=new r(c),this._client.on("connect",(function(e){d.call(u,e)})),this._client.on("connectFailed",(function(){p.call(u)})),this._client.connect(e,t,n,o,a)}function l(e,t){var n=new i.Event("close");return n.code=e,n.reason=t,n.wasClean=void 0===e||1e3===e,n}function f(e){var t=new i.Event("message");return t.data=e,t}function d(e){var t=this;this._readyState=a,this._connection=e,this._protocol=e.protocol,this._extensions=e.extensions,this._connection.on("close",(function(e,n){g.call(t,e,n)})),this._connection.on("message",(function(e){m.call(t,e)})),this.dispatchEvent(new i.Event("open"))}function p(){v.call(this),this._readyState=u;try{this.dispatchEvent(new i.Event("error"))}finally{this.dispatchEvent(l(1006,"connection failed"))}}function g(e,t){v.call(this),this._readyState=u,this.dispatchEvent(l(e,t||""))}function m(e){if(e.utf8Data)this.dispatchEvent(f(e.utf8Data));else if(e.binaryData&&"arraybuffer"===this.binaryType){for(var t=e.binaryData,n=new ArrayBuffer(t.length),r=new Uint8Array(n),o=0,i=t.length;o<i;++o)r[o]=t[o];this.dispatchEvent(f(n))}}function v(){this._client.removeAllListeners(),this._connection&&this._connection.removeAllListeners()}e.exports=h,Object.defineProperties(h.prototype,{url:{get:function(){return this._url}},readyState:{get:function(){return this._readyState}},protocol:{get:function(){return this._protocol}},extensions:{get:function(){return this._extensions}},bufferedAmount:{get:function(){return this._bufferedAmount}}}),Object.defineProperties(h.prototype,{binaryType:{get:function(){return this._binaryType},set:function(e){if("arraybuffer"!==e)throw new SyntaxError('just "arraybuffer" type allowed for "binaryType" attribute');this._binaryType=e}}}),[["CONNECTING",s],["OPEN",a],["CLOSING",c],["CLOSED",u]].forEach((function(e){Object.defineProperty(h.prototype,e[0],{get:function(){return e[1]}})})),[["CONNECTING",s],["OPEN",a],["CLOSING",c],["CLOSED",u]].forEach((function(e){Object.defineProperty(h,e[0],{get:function(){return e[1]}})})),h.prototype.send=function(e){if(this._readyState!==a)throw new Error("cannot call send() while not connected");if("string"==typeof e||e instanceof String)this._connection.sendUTF(e);else if(e instanceof Buffer)this._connection.sendBytes(e);else{if(!e.byteLength&&0!==e.byteLength)throw new Error("unknown binary data:",e);e=o(e),this._connection.sendBytes(e)}},h.prototype.close=function(e,t){switch(this._readyState){case s:p.call(this),this._client.on("connect",(function(n){e?n.close(e,t):n.close()}));break;case a:this._readyState=c,e?this._connection.close(e,t):this._connection.close()}}},406:function(e,t,n){var r=n(407).strict;e.exports=function(e){if(r(e)){var t=Buffer.from(e.buffer);return e.byteLength!==e.buffer.byteLength&&(t=t.slice(e.byteOffset,e.byteOffset+e.byteLength)),t}return Buffer.from(e)}},407:function(e,t){e.exports=o,o.strict=i,o.loose=s;var n=Object.prototype.toString,r={"[object Int8Array]":!0,"[object Int16Array]":!0,"[object Int32Array]":!0,"[object Uint8Array]":!0,"[object Uint8ClampedArray]":!0,"[object Uint16Array]":!0,"[object Uint32Array]":!0,"[object Float32Array]":!0,"[object Float64Array]":!0};function o(e){return i(e)||s(e)}function i(e){return e instanceof Int8Array||e instanceof Int16Array||e instanceof Int32Array||e instanceof Uint8Array||e instanceof Uint8ClampedArray||e instanceof Uint16Array||e instanceof Uint32Array||e instanceof Float32Array||e instanceof Float64Array}function s(e){return r[n.call(e)]}},408:function(e,t,n){e.exports={EventTarget:n(409),Event:n(410)}},409:function(e,t){function n(){"function"!=typeof this.addEventListener&&(this._listeners={},this.addEventListener=r,this.removeEventListener=o,this.dispatchEvent=i)}function r(e,t){var n,r,o;if(e&&t){for(void 0===(n=this._listeners[e])&&(this._listeners[e]=n=[]),r=0;o=n[r];r++)if(o===t)return;n.push(t)}}function o(e,t){var n,r,o;if(e&&t&&void 0!==(n=this._listeners[e])){for(r=0;o=n[r];r++)if(o===t){n.splice(r,1);break}0===n.length&&delete this._listeners[e]}}function i(e){var t,n,r,o,i,s=!1;if(!e||"string"!=typeof e.type)throw new Error("`event` must have a valid `type` property");e._yaeti&&(e.target=this,e.cancelable=!0);try{e.stopImmediatePropagation=function(){s=!0}}catch(e){}for(t=e.type,n=this._listeners[t]||[],"function"==typeof(r=this["on"+t])&&r.call(this,e),o=0;(i=n[o])&&!s;o++)i.call(this,e);return!e.defaultPrevented}e.exports=n,Object.defineProperties(n.prototype,{listeners:{get:function(){return this._listeners}}})},410:function(e,t){e.exports=function(e){this.type=e,this.isTrusted=!1,this._yaeti=!0}},411:function(e,t){var n={disableWarnings:!1,deprecationWarningMap:{},warn:function(e){!this.disableWarnings&&this.deprecationWarningMap[e]&&(console.warn("DEPRECATION WARNING: "+this.deprecationWarningMap[e]),this.deprecationWarningMap[e]=!1)}};e.exports=n},412:function(e,t,n){e.exports=n(413).version},413:function(e){e.exports=JSON.parse('{"name":"websocket","description":"Websocket Client & Server Library implementing the WebSocket protocol as specified in RFC 6455.","keywords":["websocket","websockets","socket","networking","comet","push","RFC-6455","realtime","server","client"],"author":"Brian McKelvey <theturtle32@gmail.com> (https://github.com/theturtle32)","contributors":["Iñaki Baz Castillo <ibc@aliax.net> (http://dev.sipdoc.net)"],"version":"1.0.31","repository":{"type":"git","url":"https://github.com/theturtle32/WebSocket-Node.git"},"homepage":"https://github.com/theturtle32/WebSocket-Node","engines":{"node":">=0.10.0"},"dependencies":{"debug":"^2.2.0","es5-ext":"^0.10.50","nan":"^2.14.0","typedarray-to-buffer":"^3.1.5","yaeti":"^0.0.6"},"devDependencies":{"buffer-equal":"^1.0.0","faucet":"^0.0.1","gulp":"^4.0.2","gulp-jshint":"^2.0.4","jshint-stylish":"^2.2.1","jshint":"^2.0.0","tape":"^4.9.1"},"config":{"verbose":false},"scripts":{"install":"(node-gyp rebuild 2> builderror.log) || (exit 0)","test":"faucet test/unit","gulp":"gulp"},"main":"index","directories":{"lib":"./lib"},"browser":"lib/browser.js","license":"Apache-2.0"}')},50:function(e,t){e.exports=require("events")},51:function(e,t){e.exports=require("util")},52:function(e,t,n){"use strict";function r(e){return(r="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function o(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,r.key,r)}}function i(e,t){return(i=Object.setPrototypeOf||function(e,t){return e.__proto__=t,e})(e,t)}function s(e){var t=function(){if("undefined"==typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"==typeof Proxy)return!0;try{return Date.prototype.toString.call(Reflect.construct(Date,[],(function(){}))),!0}catch(e){return!1}}();return function(){var n,r=c(e);if(t){var o=c(this).constructor;n=Reflect.construct(r,arguments,o)}else n=r.apply(this,arguments);return a(this,n)}}function a(e,t){return!t||"object"!==r(t)&&"function"!=typeof t?function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e):t}function c(e){return(c=Object.setPrototypeOf?Object.getPrototypeOf:function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}var u=function(e){!function(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),t&&i(e,t)}(c,e);var t,n,r,a=s(c);function c(e){var t,n=e.onEventTypes,r=e.sendFuncName,o=e.path;return function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}(this,c),(t=a.call(this)).path=o,t._onEventTypes=n||[],t._sendFuncName=r,t.connectStatus=!1,t.responseCbs={},t._connectEnd=null,t._connectError=null,t._connectTimeout=null,t._connectConnect=null,t._connectClose=null,t.subscribeMethod=null,t}return t=c,(n=[{key:"_connected",value:function(){this.connectStatus=!0,this._connectConnect&&this._connectConnect()}},{key:"_closed",value:function(){this.connectStatus=!1,this._connectClose&&this._connectClose()}},{key:"_errored",value:function(e){this._connectError&&this._connectError(e)}},{key:"_parse",value:function(e){var t=this,n=[];e.forEach((function(e){if(e)try{var t=JSON.parse(e);if(!(t instanceof Array)&&t.result)try{t.result=JSON.parse(t.result)}catch(e){}n.push(t)}catch(e){}})),n.forEach((function(e){if(e instanceof Array||e.id)if(e.id)t.responseCbs[e.id]&&t.responseCbs[e.id](e);else for(var n=0;n<e.length;n++)if(e[n].id){var r=e[n].id;t.responseCbs[r]&&t.responseCbs[r](e)}else t.subscribeMethod&&t.subscribeMethod(e[n]);else t.subscribeMethod&&t.subscribeMethod(e)}))}},{key:"_checkOnType",value:function(e){if(this._onEventTypes.indexOf(e)<0)return!1;var t=e.substring(0,1).toUpperCase()+e.substring(1);return"_connect".concat(t)}},{key:"_onSend",value:function(e){var t=this,n=function(e){var t;if(e instanceof Array){for(var n=0;n<e.length;n++)if(e[n].id){t=e[n].id;break}}else t=e.id||null;return t}(e);if(n)return new Promise((function(e,r){var o=!1,i={id:n,abort:function(){o=!0}};t.responseCbs[n]=function(t){if(a(),t&&t.error)return r(t);e(t)};var s=t._addReq({request:i,rej:function(e){a(),r(e)}}),a=function(){for(var e in c&&clearTimeout(c),c=null,t._removeReq(s),t.responseCbs)if(t.responseCbs[e]===n){delete t.responseCbs[e];break}},c=t.timeout?setTimeout((function(){if(!o)return a(),r(t.ERRORS.TIMEOUT(t.timeout))}),t.timeout):null}))}},{key:"_send",value:function(e){return this.connectStatus?(this.socket[this._sendFuncName](JSON.stringify(e)),this._onSend(e)):Promise.reject(this.ERRORS.CONNECT(this.path))}},{key:"on",value:function(e,t){var n=this._checkOnType(e);return n?t?void(this[n]=t):this.ERRORS.IPC_ON_CB(e):this.ERRORS.IPC_ON(e)}},{key:"remove",value:function(e){var t=this._checkOnType(e);t&&(this[t]=null)}},{key:"request",value:function(e,t){var n=this._getRequestPayload(e,t);return n instanceof Error?Promise.reject(n):this._send(n)}},{key:"sendNotification",value:function(e,t){var n=this._getNotificationPayload(e,t);if(n instanceof Error)return n;this._send(n)}},{key:"batch",value:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=this._getBatchPayload(e);return t instanceof Error?Promise.reject(t):this._send(t)}},{key:"subscribe",value:function(e){if("function"!=typeof e)throw new Error("[Error] callback should be a function.");this.subscribeMethod=e}},{key:"unsubscribe",value:function(){this.subscribeMethod=null}}])&&o(t.prototype,n),r&&o(t,r),c}(n(30).a);t.a=u},57:function(e,t,n){var r,o,i,s,a=this&&this.__extends||(s=function(e,t){return(s=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(e,t){e.__proto__=t}||function(e,t){for(var n in t)t.hasOwnProperty(n)&&(e[n]=t[n])})(e,t)},function(e,t){function n(){this.constructor=e}s(e,t),e.prototype=null===t?Object.create(t):(n.prototype=t.prototype,new n)});!function(s){if("object"==typeof e.exports){var a=s(n(58),t);void 0!==a&&(e.exports=a)}else o=[n,t],void 0===(i="function"==typeof(r=s)?r.apply(t,o):r)||(e.exports=i)}((function(e,t){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var n=Object.prototype.hasOwnProperty,r="function"==typeof Number.isSafeInteger?Number.isSafeInteger:function(e){return"number"==typeof e&&isFinite(e)&&e===Math.floor(e)&&Math.abs(e)<=9007199254740991},o=function(){function e(){this.jsonrpc="2.0"}return e.prototype.serialize=function(){return JSON.stringify(this)},e.VERSION="2.0",e}();t.JsonRpc=o;var i=function(e){function t(t,n,r){var o=e.call(this)||this;return o.id=t,o.method=n,void 0!==r&&(o.params=r),o}return a(t,e),t}(o);t.RequestObject=i;var s=function(e){function t(t,n){var r=e.call(this)||this;return r.method=t,void 0!==n&&(r.params=n),r}return a(t,e),t}(o);t.NotificationObject=s;var c=function(e){function t(t,n){var r=e.call(this)||this;return r.id=t,r.result=n,r}return a(t,e),t}(o);t.SuccessObject=c;var u=function(e){function t(t,n){var r=e.call(this)||this;return r.id=t,r.error=n,r.id=t,r.error=n,r}return a(t,e),t}(o);t.ErrorObject=u;var h=function(e,t){this.payload=e,this.type=t,this.payload=e,this.type=t};t.JsonRpcParsed=h;var l=function(){function e(e,t,n){this.message=e,this.code=r(t)?t:0,null!=n&&(this.data=n)}return e.invalidRequest=function(t){return new e("Invalid request",-32600,t)},e.methodNotFound=function(t){return new e("Method not found",-32601,t)},e.invalidParams=function(t){return new e("Invalid params",-32602,t)},e.internalError=function(t){return new e("Internal error",-32603,t)},e.parseError=function(t){return new e("Parse error",-32700,t)},e}();function f(e,t,n){var r=new i(e,t,n);return b(r,!0),r}function d(e,t){var n=new s(e,t);return b(n,!0),n}function p(e,t){var n=new c(e,t);return b(n,!0),n}function g(e,t){var n=new u(e,t);return b(n,!0),n}function m(e){if(!k(e))return new h(l.invalidRequest(e),"invalid");var t;try{t=JSON.parse(e)}catch(t){return new h(l.parseError(e),"invalid")}return v(t)}function v(e){if(!Array.isArray(e))return y(e);if(0===e.length)return new h(l.invalidRequest(e),"invalid");for(var t=[],n=0,r=e.length;n<r;n++)t[n]=y(e[n]);return t}function y(e){var t=null,r=null,a="invalid";if(null==e||e.jsonrpc!==o.VERSION)t=l.invalidRequest(e),a="invalid";else if(n.call(e,"id")){if(n.call(e,"method")){t=b(r=new i((d=e).id,d.method,d.params)),a="request"}else if(n.call(e,"result")){t=b(r=new c((d=e).id,d.result)),a="success"}else if(n.call(e,"error")){if(a="error",null==(d=e).error)t=l.internalError(d);else{var f=new l(d.error.message,d.error.code,d.error.data);t=f.message!==d.error.message||f.code!==d.error.code?l.internalError(d):b(r=new u(d.id,f))}}}else{var d;t=b(r=new s((d=e).method,d.params)),a="notification"}return null==t&&null!=r?new h(r,a):new h(null!=t?t:l.invalidRequest(e),"invalid")}function b(e,t){var n=null;if(e instanceof i?(null==(n=_(e.id))&&(n=E(e.method)),null==n&&(n=S(e.params))):e instanceof s?null==(n=E(e.method))&&(n=S(e.params)):e instanceof c?null==(n=_(e.id))&&(n=void 0===e.result?l.internalError("Result must exist for success Response objects"):null):e instanceof u&&null==(n=_(e.id,!0))&&(n=function(e){if(!(e instanceof l))return l.internalError("Error must be an instance of JsonRpcError");if(!r(e.code))return l.internalError("Invalid error code. It must be an integer.");if(!k(e.message))return l.internalError("Message must exist or must be a string.");return null}(e.error)),t&&null!=n)throw n;return n}function _(e,t){return t&&null===e||k(e)||r(e)?null:l.internalError('"id" must be provided, a string or an integer.')}function E(e){return k(e)?null:l.invalidRequest(e)}function S(e){if(void 0===e)return null;if(Array.isArray(e)||null!=(t=e)&&"object"==typeof t&&!Array.isArray(t))try{return JSON.stringify(e),null}catch(t){return l.parseError(e)}var t;return l.invalidParams(e)}function k(e){return""!==e&&"string"==typeof e}t.JsonRpcError=l,t.request=f,t.notification=d,t.success=p,t.error=g,t.parse=m,t.parseJsonRpcObject=v,t.parseJsonRpcString=m,t.parseObject=y;var w={JsonRpc:o,JsonRpcError:l,request:f,notification:d,success:p,error:g,parse:m,parseObject:y,parseJsonRpcObject:v,parseJsonRpcString:t.parseJsonRpcString};t.jsonrpc=w,t.default=w}))},58:function(e,t){function n(e){var t=new Error("Cannot find module '"+e+"'");throw t.code="MODULE_NOT_FOUND",t}n.keys=function(){return[]},n.resolve=n,e.exports=n,n.id=58},76:function(e,t,n){var r=t.noop=function(){};function o(e,t,n){this.logFunction=n,this.identifier=e,this.uniqueID=t,this.buffer=[]}t.extend=function(e,t){for(var n in t)e[n]=t[n]},t.eventEmitterListenerCount=n(50).EventEmitter.listenerCount||function(e,t){return e.listeners(t).length},t.bufferAllocUnsafe=Buffer.allocUnsafe?Buffer.allocUnsafe:function(e){return new Buffer(e)},t.bufferFromString=Buffer.from?Buffer.from:function(e,t){return new Buffer(e,t)},t.BufferingLogger=function(e,t){var i=n(195)(e);if(i.enabled){var s=new o(e,t,i),a=s.log.bind(s);return a.printOutput=s.printOutput.bind(s),a.enabled=i.enabled,a}return i.printOutput=r,i},o.prototype.log=function(){return this.buffer.push([new Date,Array.prototype.slice.call(arguments)]),this},o.prototype.clear=function(){return this.buffer=[],this},o.prototype.printOutput=function(e){e||(e=this.logFunction);var t=this.uniqueID;this.buffer.forEach((function(n){var r=n[0].toLocaleString(),o=n[1].slice(),i=o[0];null!=i&&(i="%s - %s - "+i.toString(),o.splice(0,1,i,r,t),e.apply(global,o))}))}}})}));